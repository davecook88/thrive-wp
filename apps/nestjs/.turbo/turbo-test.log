

> @thrive/api@0.0.1 test /Users/davidcook/personal/thrive-wp/apps/nestjs
> dotenv -e .env.test -- vitest run

[?25l[33m[7m[33m Vitest [33m[27m "deps.inline" is deprecated. If you rely on vite-node directly, use "server.deps.inline" instead. Otherwise, consider using "deps.optimizer.ssr.include"[39m

[1m[46m RUN [49m[22m [36mv3.2.4 [39m[90m/Users/davidcook/personal/thrive-wp/apps/nestjs[39m

[?2026h
[1m[33m ‚ùØ [39m[22mtest/credit-tiers-integration.e2e.spec.ts[2m [queued][22m

[2m Test Files [22m[1m[32m0 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[32m0 passed[39m[22m[90m (0)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m599ms
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K
[1m[33m ‚ùØ [39m[22mtest/credit-tiers-integration.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/database.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/payments-session-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/teacher-availability.e2e.spec.ts[2m [queued][22m

[2m Test Files [22m[1m[32m0 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[32m0 passed[39m[22m[90m (0)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m701ms
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K
[1m[33m ‚ùØ [39m[22msrc/teachers/teachers.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/credit-tiers-integration.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/database.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/group-class-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/payments-session-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/payments-webhook-group-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/teacher-availability.e2e.spec.ts[2m [queued][22m

[2m Test Files [22m[1m[32m0 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[32m0 passed[39m[22m[90m (0)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m903ms
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K
[1m[33m ‚ùØ [39m[22msrc/teachers/teachers.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/credit-tiers-integration.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/database.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/group-class-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/payments-session-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/payments-webhook-group-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/teacher-availability.e2e.spec.ts[2m [queued][22m

[2m Test Files [22m[1m[32m0 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[32m0 passed[39m[22m[90m (0)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m1.93s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[90mstdout[2m | test/database.e2e.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | test/database.e2e.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.

[90mstdout[2m | test/payments-webhook-group-booking.e2e.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | test/payments-webhook-group-booking.e2e.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.

[90mstdout[2m | test/credit-tiers-integration.e2e.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | test/credit-tiers-integration.e2e.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.

[90mstdout[2m | test/teacher-availability.e2e.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | test/teacher-availability.e2e.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.

[90mstdout[2m | src/teachers/teachers.service.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | src/teachers/teachers.service.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.

[90mstdout[2m | test/payments-session-booking.e2e.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | test/payments-session-booking.e2e.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.

[90mstdout[2m | test/group-class-booking.e2e.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | test/group-class-booking.e2e.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.


[1m[33m ‚ùØ [39m[22msrc/teachers/teachers.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/credit-tiers-integration.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/database.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/group-class-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/payments-session-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/payments-webhook-group-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/teacher-availability.e2e.spec.ts[2m [queued][22m

[2m Test Files [22m[1m[32m0 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[32m0 passed[39m[22m[90m (0)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m2.94s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K
[1m[33m ‚ùØ [39m[22msrc/teachers/teachers.service.spec.ts[2m 0/10[22m
[1m[33m ‚ùØ [39m[22mtest/credit-tiers-integration.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/database.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/group-class-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/payments-session-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/payments-webhook-group-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/teacher-availability.e2e.spec.ts[2m [queued][22m

[2m Test Files [22m[1m[32m0 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[32m0 passed[39m[22m[90m (10)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m3.87s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[90mstdout[2m | src/teachers/teachers.service.spec.ts[2m > [22m[2mTeachersService[2m > [22m[2mgetTeacherAvailability[2m > [22m[2mshould return wrapped endTime for spanning rules
[22m[39mFetched availabilities count: [33m1[39m
Mapped rules and exceptions: {
  rules: [
    {
      id: [33m1[39m,
      dayOfWeek: [33m3[39m,
      startTime: [32m'18:00'[39m,
      endTime: [32m'04:00'[39m,
      maxBookings: [1mnull[22m
    }
  ],
  exceptions: []
}

[90mstdout[2m | src/teachers/teachers.service.spec.ts[2m > [22m[2mTeachersService[2m > [22m[2mpreviewTeacherAvailability[2m > [22m[2mshould generate correct preview windows for spanning rules
[22m[39msessionsByTeacher: { sessionsByTeacher: [32m'{}'[39m }
Generated preview windows: [
  {
    start: [32m'2025-09-03T18:00:00.000Z'[39m,
    end: [32m'2025-09-04T04:00:00.000Z'[39m,
    teacherIds: [ [33m1[39m ]
  }
]

[90mstdout[2m | src/teachers/teachers.service.spec.ts[2m > [22m[2mTeachersService[2m > [22m[2mpreviewTeacherAvailability[2m > [22m[2mshould generate correct preview windows for normal rules
[22m[39msessionsByTeacher: { sessionsByTeacher: [32m'{}'[39m }
Generated preview windows: [
  {
    start: [32m'2025-09-01T09:00:00.000Z'[39m,
    end: [32m'2025-09-01T17:00:00.000Z'[39m,
    teacherIds: [ [33m1[39m ]
  }
]

[90mstdout[2m | src/teachers/teachers.service.spec.ts[2m > [22m[2mTeachersService[2m > [22m[2mpreviewTeacherAvailability[2m > [22m[2mshould handle multiple days with spanning rules
[22m[39msessionsByTeacher: { sessionsByTeacher: [32m'{}'[39m }
Generated preview windows: [
  {
    start: [32m'2025-09-03T18:00:00.000Z'[39m,
    end: [32m'2025-09-04T04:00:00.000Z'[39m,
    teacherIds: [ [33m1[39m ]
  }
]

 [31m‚ùØ[39m src/teachers/teachers.service.spec.ts [2m([22m[2m10 tests[22m[2m)[22m[32m 37[2mms[22m[39m
   [32m‚úì[39m TeachersService[2m > [22mshould be defined[32m 16[2mms[22m[39m
   [32m‚úì[39m TeachersService[2m > [22mupdateTeacherAvailability[2m > [22mshould handle rules that span midnight[32m 2[2mms[22m[39m
   [32m‚úì[39m TeachersService[2m > [22mupdateTeacherAvailability[2m > [22mshould handle normal rules without spanning[32m 1[2mms[22m[39m
   [32m‚úì[39m TeachersService[2m > [22mupdateTeacherAvailability[2m > [22mshould handle exceptions that span midnight[32m 1[2mms[22m[39m
   [32m‚úì[39m TeachersService[2m > [22mupdateTeacherAvailability[2m > [22mshould throw NotFoundException if teacher not found[32m 3[2mms[22m[39m
   [32m‚úì[39m TeachersService[2m > [22mgetTeacherAvailability[2m > [22mshould return wrapped endTime for spanning rules[32m 4[2mms[22m[39m
   [32m‚úì[39m TeachersService[2m > [22mpreviewTeacherAvailability[2m > [22mshould generate correct preview windows for spanning rules[32m 2[2mms[22m[39m
   [32m‚úì[39m TeachersService[2m > [22mpreviewTeacherAvailability[2m > [22mshould generate correct preview windows for normal rules[32m 1[2mms[22m[39m
   [32m‚úì[39m TeachersService[2m > [22mpreviewTeacherAvailability[2m > [22mshould handle multiple days with spanning rules[32m 1[2mms[22m[39m
   [32m‚úì[39m TeachersService[2m > [22mpreviewTeacherAvailability[2m > [22mshould throw BadRequestException for range exceeding 90 days[32m 2[2mms[22m[39m

[1m[33m ‚ùØ [39m[22msrc/teachers/teachers.service.spec.ts[2m 10/10[22m
[1m[33m ‚ùØ [39m[22mtest/credit-tiers-integration.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/database.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/group-class-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/payments-session-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/payments-webhook-group-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/teacher-availability.e2e.spec.ts[2m [queued][22m

[2m Test Files [22m[1m[31m1 failed[39m[22m[2m | [22m[1m[32m0 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[32m10 passed[39m[22m[90m (10)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m3.98s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K
[1m[33m ‚ùØ [39m[22mtest/credit-tiers-integration.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/database.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/group-class-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/payments-session-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/payments-webhook-group-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/students-api.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/teacher-availability.e2e.spec.ts[2m [queued][22m

[2m Test Files [22m[1m[31m1 failed[39m[22m[2m | [22m[1m[32m0 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[32m10 passed[39m[22m[90m (10)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m4.08s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[90mstdout[2m | test/students-api.e2e.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | test/students-api.e2e.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.


[1m[33m ‚ùØ [39m[22mtest/credit-tiers-integration.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/database.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/group-class-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/payments-session-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/payments-webhook-group-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/students-api.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/teacher-availability.e2e.spec.ts[2m [queued][22m

[2m Test Files [22m[1m[31m1 failed[39m[22m[2m | [22m[1m[32m0 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[32m10 passed[39m[22m[90m (10)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m4.89s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[90mstdout[2m | test/group-class-booking.e2e.spec.ts[2m > [22m[2mGroup Class Booking (e2e)
[22m[39m
[TEST SETUP] Running database migrations...

MigrationTestDataSource.options: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  entities: [],
  migrations: [
    [36m[class InitialSchema1733770000000][39m,
    [36m[class AddPasswordHashToUsers1733771000001][39m,
    [36m[class AddTeacherAndAvailability1733772000002][39m,
    [36m[class AddAdminTable1756431459155][39m,
    [36m[class AddStudentTable1756431459156][39m,
    [36m[class AddSchedulingTables1756431459157][39m,
    [36m[class AddWaitlistTable1756431459158][39m,
    [36m[class AddPricingSystemTables1756431459159][39m,
    [36m[class RenameToStripeProductMap1756431459160][39m,
    [36m[class AddDraftStatuses1756431459161][39m,
    [36m[class AddStudentPackagesTables1759000000000][39m,
    [36m[class AddPackageFieldsToBooking1759000000001][39m,
    [36m[class AddCancellationPolicies1759000000002][39m,
    [36m[class AddGroupClassesTables1759000000003][39m,
    [36m[class AddTeacherProfileFields1759000000004][39m,
    [36m[class GroupClassMultipleLevels1759000000005][39m,
    [36m[class AddCourseProgramsTables1760000000000][39m,
    [36m[class AddServiceTypeAndTeacherTierToStripeProductMap1762000000000][39m,
    [36m[class BundlePackagesMigration1762000000010][39m,
    [36m[class AddStripeProductMapFKToStudentPackage1762000000020][39m,
    [36m[class AddPackageUseIdToBooking1762000000030][39m,
    [36m[class AddAllowanceIdToPackageUse1762000000040][39m,
    [36m[class RemoveLegacyCourseTables1762000000050][39m,
    [36m[class SimplifyCourseProgramSchema1763000000000][39m,
    [36m[class AddCourseProgramLevels1764000000000][39m,
    [36m[class AddCourseCohorts1765000000000][39m,
    [36m[class RemoveGroupClassRruleFields1766000000000][39m
  ],
  synchronize: [33mfalse[39m,
  dropSchema: [33mtrue[39m,
  logging: [33mfalse[39m
}
Target DB for migrations: wordpress_test
Initializing MigrationTestDataSource...

[90mstdout[2m | test/database.e2e.spec.ts[2m > [22m[2mDatabase Integration (e2e)
[22m[39m
[TEST SETUP] Running database migrations...

MigrationTestDataSource.options: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  entities: [],
  migrations: [
    [36m[class InitialSchema1733770000000][39m,
    [36m[class AddPasswordHashToUsers1733771000001][39m,
    [36m[class AddTeacherAndAvailability1733772000002][39m,
    [36m[class AddAdminTable1756431459155][39m,
    [36m[class AddStudentTable1756431459156][39m,
    [36m[class AddSchedulingTables1756431459157][39m,
    [36m[class AddWaitlistTable1756431459158][39m,
    [36m[class AddPricingSystemTables1756431459159][39m,
    [36m[class RenameToStripeProductMap1756431459160][39m,
    [36m[class AddDraftStatuses1756431459161][39m,
    [36m[class AddStudentPackagesTables1759000000000][39m,
    [36m[class AddPackageFieldsToBooking1759000000001][39m,
    [36m[class AddCancellationPolicies1759000000002][39m,
    [36m[class AddGroupClassesTables1759000000003][39m,
    [36m[class AddTeacherProfileFields1759000000004][39m,
    [36m[class GroupClassMultipleLevels1759000000005][39m,
    [36m[class AddCourseProgramsTables1760000000000][39m,
    [36m[class AddServiceTypeAndTeacherTierToStripeProductMap1762000000000][39m,
    [36m[class BundlePackagesMigration1762000000010][39m,
    [36m[class AddStripeProductMapFKToStudentPackage1762000000020][39m,
    [36m[class AddPackageUseIdToBooking1762000000030][39m,
    [36m[class AddAllowanceIdToPackageUse1762000000040][39m,
    [36m[class RemoveLegacyCourseTables1762000000050][39m,
    [36m[class SimplifyCourseProgramSchema1763000000000][39m,
    [36m[class AddCourseProgramLevels1764000000000][39m,
    [36m[class AddCourseCohorts1765000000000][39m,
    [36m[class RemoveGroupClassRruleFields1766000000000][39m
  ],
  synchronize: [33mfalse[39m,
  dropSchema: [33mtrue[39m,
  logging: [33mfalse[39m
}
Target DB for migrations: wordpress_test
Initializing MigrationTestDataSource...

[90mstdout[2m | test/payments-webhook-group-booking.e2e.spec.ts[2m > [22m[2mPaymentsService - Group Session Booking via Package Purchase Webhook
[22m[39m
[TEST SETUP] Running database migrations...

MigrationTestDataSource.options: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  entities: [],
  migrations: [
    [36m[class InitialSchema1733770000000][39m,
    [36m[class AddPasswordHashToUsers1733771000001][39m,
    [36m[class AddTeacherAndAvailability1733772000002][39m,
    [36m[class AddAdminTable1756431459155][39m,
    [36m[class AddStudentTable1756431459156][39m,
    [36m[class AddSchedulingTables1756431459157][39m,
    [36m[class AddWaitlistTable1756431459158][39m,
    [36m[class AddPricingSystemTables1756431459159][39m,
    [36m[class RenameToStripeProductMap1756431459160][39m,
    [36m[class AddDraftStatuses1756431459161][39m,
    [36m[class AddStudentPackagesTables1759000000000][39m,
    [36m[class AddPackageFieldsToBooking1759000000001][39m,
    [36m[class AddCancellationPolicies1759000000002][39m,
    [36m[class AddGroupClassesTables1759000000003][39m,
    [36m[class AddTeacherProfileFields1759000000004][39m,
    [36m[class GroupClassMultipleLevels1759000000005][39m,
    [36m[class AddCourseProgramsTables1760000000000][39m,
    [36m[class AddServiceTypeAndTeacherTierToStripeProductMap1762000000000][39m,
    [36m[class BundlePackagesMigration1762000000010][39m,
    [36m[class AddStripeProductMapFKToStudentPackage1762000000020][39m,
    [36m[class AddPackageUseIdToBooking1762000000030][39m,
    [36m[class AddAllowanceIdToPackageUse1762000000040][39m,
    [36m[class RemoveLegacyCourseTables1762000000050][39m,
    [36m[class SimplifyCourseProgramSchema1763000000000][39m,
    [36m[class AddCourseProgramLevels1764000000000][39m,
    [36m[class AddCourseCohorts1765000000000][39m,
    [36m[class RemoveGroupClassRruleFields1766000000000][39m
  ],
  synchronize: [33mfalse[39m,
  dropSchema: [33mtrue[39m,
  logging: [33mfalse[39m
}
Target DB for migrations: wordpress_test
Initializing MigrationTestDataSource...

[90mstdout[2m | test/teacher-availability.e2e.spec.ts[2m > [22m[2mTeacherAvailabilityService (e2e)
[22m[39m
[TEST SETUP] Running database migrations...

MigrationTestDataSource.options: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  entities: [],
  migrations: [
    [36m[class InitialSchema1733770000000][39m,
    [36m[class AddPasswordHashToUsers1733771000001][39m,
    [36m[class AddTeacherAndAvailability1733772000002][39m,
    [36m[class AddAdminTable1756431459155][39m,
    [36m[class AddStudentTable1756431459156][39m,
    [36m[class AddSchedulingTables1756431459157][39m,
    [36m[class AddWaitlistTable1756431459158][39m,
    [36m[class AddPricingSystemTables1756431459159][39m,
    [36m[class RenameToStripeProductMap1756431459160][39m,
    [36m[class AddDraftStatuses1756431459161][39m,
    [36m[class AddStudentPackagesTables1759000000000][39m,
    [36m[class AddPackageFieldsToBooking1759000000001][39m,
    [36m[class AddCancellationPolicies1759000000002][39m,
    [36m[class AddGroupClassesTables1759000000003][39m,
    [36m[class AddTeacherProfileFields1759000000004][39m,
    [36m[class GroupClassMultipleLevels1759000000005][39m,
    [36m[class AddCourseProgramsTables1760000000000][39m,
    [36m[class AddServiceTypeAndTeacherTierToStripeProductMap1762000000000][39m,
    [36m[class BundlePackagesMigration1762000000010][39m,
    [36m[class AddStripeProductMapFKToStudentPackage1762000000020][39m,
    [36m[class AddPackageUseIdToBooking1762000000030][39m,
    [36m[class AddAllowanceIdToPackageUse1762000000040][39m,
    [36m[class RemoveLegacyCourseTables1762000000050][39m,
    [36m[class SimplifyCourseProgramSchema1763000000000][39m,
    [36m[class AddCourseProgramLevels1764000000000][39m,
    [36m[class AddCourseCohorts1765000000000][39m,
    [36m[class RemoveGroupClassRruleFields1766000000000][39m
  ],
  synchronize: [33mfalse[39m,
  dropSchema: [33mtrue[39m,
  logging: [33mfalse[39m
}
Target DB for migrations: wordpress_test
Initializing MigrationTestDataSource...

[90mstdout[2m | test/payments-session-booking.e2e.spec.ts[2m > [22m[2mPaymentsService.createSessionAndBookingFromMetadata (e2e)
[22m[39m
[TEST SETUP] Running database migrations...

MigrationTestDataSource.options: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  entities: [],
  migrations: [
    [36m[class InitialSchema1733770000000][39m,
    [36m[class AddPasswordHashToUsers1733771000001][39m,
    [36m[class AddTeacherAndAvailability1733772000002][39m,
    [36m[class AddAdminTable1756431459155][39m,
    [36m[class AddStudentTable1756431459156][39m,
    [36m[class AddSchedulingTables1756431459157][39m,
    [36m[class AddWaitlistTable1756431459158][39m,
    [36m[class AddPricingSystemTables1756431459159][39m,
    [36m[class RenameToStripeProductMap1756431459160][39m,
    [36m[class AddDraftStatuses1756431459161][39m,
    [36m[class AddStudentPackagesTables1759000000000][39m,
    [36m[class AddPackageFieldsToBooking1759000000001][39m,
    [36m[class AddCancellationPolicies1759000000002][39m,
    [36m[class AddGroupClassesTables1759000000003][39m,
    [36m[class AddTeacherProfileFields1759000000004][39m,
    [36m[class GroupClassMultipleLevels1759000000005][39m,
    [36m[class AddCourseProgramsTables1760000000000][39m,
    [36m[class AddServiceTypeAndTeacherTierToStripeProductMap1762000000000][39m,
    [36m[class BundlePackagesMigration1762000000010][39m,
    [36m[class AddStripeProductMapFKToStudentPackage1762000000020][39m,
    [36m[class AddPackageUseIdToBooking1762000000030][39m,
    [36m[class AddAllowanceIdToPackageUse1762000000040][39m,
    [36m[class RemoveLegacyCourseTables1762000000050][39m,
    [36m[class SimplifyCourseProgramSchema1763000000000][39m,
    [36m[class AddCourseProgramLevels1764000000000][39m,
    [36m[class AddCourseCohorts1765000000000][39m,
    [36m[class RemoveGroupClassRruleFields1766000000000][39m
  ],
  synchronize: [33mfalse[39m,
  dropSchema: [33mtrue[39m,
  logging: [33mfalse[39m
}
Target DB for migrations: wordpress_test
Initializing MigrationTestDataSource...


[1m[33m ‚ùØ [39m[22mtest/credit-tiers-integration.e2e.spec.ts[2m 0/21[22m
[1m[33m ‚ùØ [39m[22mtest/database.e2e.spec.ts[2m 0/2[22m
[1m[33m ‚ùØ [39m[22mtest/group-class-booking.e2e.spec.ts[2m 0/2[22m
[1m[33m ‚ùØ [39m[22mtest/payments-session-booking.e2e.spec.ts[2m 0/8[22m
[1m[33m ‚ùØ [39m[22mtest/payments-webhook-group-booking.e2e.spec.ts[2m 0/6[22m
[1m[33m ‚ùØ [39m[22mtest/students-api.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/teacher-availability.e2e.spec.ts[2m 0/13[22m

[2m Test Files [22m[1m[31m1 failed[39m[22m[2m | [22m[1m[32m0 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[32m10 passed[39m[22m[90m (62)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m5.14s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[90mstdout[2m | test/credit-tiers-integration.e2e.spec.ts[2m > [22m[2mCredit Tier System Integration (e2e)
[22m[39m
[TEST SETUP] Running database migrations...

MigrationTestDataSource.options: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  entities: [],
  migrations: [
    [36m[class InitialSchema1733770000000][39m,
    [36m[class AddPasswordHashToUsers1733771000001][39m,
    [36m[class AddTeacherAndAvailability1733772000002][39m,
    [36m[class AddAdminTable1756431459155][39m,
    [36m[class AddStudentTable1756431459156][39m,
    [36m[class AddSchedulingTables1756431459157][39m,
    [36m[class AddWaitlistTable1756431459158][39m,
    [36m[class AddPricingSystemTables1756431459159][39m,
    [36m[class RenameToStripeProductMap1756431459160][39m,
    [36m[class AddDraftStatuses1756431459161][39m,
    [36m[class AddStudentPackagesTables1759000000000][39m,
    [36m[class AddPackageFieldsToBooking1759000000001][39m,
    [36m[class AddCancellationPolicies1759000000002][39m,
    [36m[class AddGroupClassesTables1759000000003][39m,
    [36m[class AddTeacherProfileFields1759000000004][39m,
    [36m[class GroupClassMultipleLevels1759000000005][39m,
    [36m[class AddCourseProgramsTables1760000000000][39m,
    [36m[class AddServiceTypeAndTeacherTierToStripeProductMap1762000000000][39m,
    [36m[class BundlePackagesMigration1762000000010][39m,
    [36m[class AddStripeProductMapFKToStudentPackage1762000000020][39m,
    [36m[class AddPackageUseIdToBooking1762000000030][39m,
    [36m[class AddAllowanceIdToPackageUse1762000000040][39m,
    [36m[class RemoveLegacyCourseTables1762000000050][39m,
    [36m[class SimplifyCourseProgramSchema1763000000000][39m,
    [36m[class AddCourseProgramLevels1764000000000][39m,
    [36m[class AddCourseCohorts1765000000000][39m,
    [36m[class RemoveGroupClassRruleFields1766000000000][39m
  ],
  synchronize: [33mfalse[39m,
  dropSchema: [33mtrue[39m,
  logging: [33mfalse[39m
}
Target DB for migrations: wordpress_test
Initializing MigrationTestDataSource...


[1m[33m ‚ùØ [39m[22mtest/credit-tiers-integration.e2e.spec.ts[2m 0/21[22m
[1m[33m ‚ùØ [39m[22mtest/database.e2e.spec.ts[2m 0/2[22m
[1m[33m ‚ùØ [39m[22mtest/group-class-booking.e2e.spec.ts[2m 0/2[22m
[1m[33m ‚ùØ [39m[22mtest/payments-session-booking.e2e.spec.ts[2m 0/8[22m
[1m[33m ‚ùØ [39m[22mtest/payments-webhook-group-booking.e2e.spec.ts[2m 0/6[22m
[1m[33m ‚ùØ [39m[22mtest/students-api.e2e.spec.ts[2m 0/3[22m
[1m[33m ‚ùØ [39m[22mtest/teacher-availability.e2e.spec.ts[2m 0/13[22m

[2m Test Files [22m[1m[31m1 failed[39m[22m[2m | [22m[1m[32m0 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[32m10 passed[39m[22m[90m (65)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m5.44s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[90mstdout[2m | test/students-api.e2e.spec.ts[2m > [22m[2mStudents API (e2e)
[22m[39m
[TEST SETUP] Running database migrations...

MigrationTestDataSource.options: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  entities: [],
  migrations: [
    [36m[class InitialSchema1733770000000][39m,
    [36m[class AddPasswordHashToUsers1733771000001][39m,
    [36m[class AddTeacherAndAvailability1733772000002][39m,
    [36m[class AddAdminTable1756431459155][39m,
    [36m[class AddStudentTable1756431459156][39m,
    [36m[class AddSchedulingTables1756431459157][39m,
    [36m[class AddWaitlistTable1756431459158][39m,
    [36m[class AddPricingSystemTables1756431459159][39m,
    [36m[class RenameToStripeProductMap1756431459160][39m,
    [36m[class AddDraftStatuses1756431459161][39m,
    [36m[class AddStudentPackagesTables1759000000000][39m,
    [36m[class AddPackageFieldsToBooking1759000000001][39m,
    [36m[class AddCancellationPolicies1759000000002][39m,
    [36m[class AddGroupClassesTables1759000000003][39m,
    [36m[class AddTeacherProfileFields1759000000004][39m,
    [36m[class GroupClassMultipleLevels1759000000005][39m,
    [36m[class AddCourseProgramsTables1760000000000][39m,
    [36m[class AddServiceTypeAndTeacherTierToStripeProductMap1762000000000][39m,
    [36m[class BundlePackagesMigration1762000000010][39m,
    [36m[class AddStripeProductMapFKToStudentPackage1762000000020][39m,
    [36m[class AddPackageUseIdToBooking1762000000030][39m,
    [36m[class AddAllowanceIdToPackageUse1762000000040][39m,
    [36m[class RemoveLegacyCourseTables1762000000050][39m,
    [36m[class SimplifyCourseProgramSchema1763000000000][39m,
    [36m[class AddCourseProgramLevels1764000000000][39m,
    [36m[class AddCourseCohorts1765000000000][39m,
    [36m[class RemoveGroupClassRruleFields1766000000000][39m
  ],
  synchronize: [33mfalse[39m,
  dropSchema: [33mtrue[39m,
  logging: [33mfalse[39m
}
Target DB for migrations: wordpress_test
Initializing MigrationTestDataSource...

[90mstdout[2m | test/students-api.e2e.spec.ts[2m > [22m[2mStudents API (e2e)
[22m[39mRunning migrations...

[90mstdout[2m | test/payments-webhook-group-booking.e2e.spec.ts[2m > [22m[2mPaymentsService - Group Session Booking via Package Purchase Webhook
[22m[39mRunning migrations...

[90mstdout[2m | test/payments-session-booking.e2e.spec.ts[2m > [22m[2mPaymentsService.createSessionAndBookingFromMetadata (e2e)
[22m[39mRunning migrations...

[90mstdout[2m | test/credit-tiers-integration.e2e.spec.ts[2m > [22m[2mCredit Tier System Integration (e2e)
[22m[39mRunning migrations...

[90mstdout[2m | test/group-class-booking.e2e.spec.ts[2m > [22m[2mGroup Class Booking (e2e)
[22m[39mRunning migrations...

[90mstdout[2m | test/teacher-availability.e2e.spec.ts[2m > [22m[2mTeacherAvailabilityService (e2e)
[22m[39mRunning migrations...

[90mstdout[2m | test/database.e2e.spec.ts[2m > [22m[2mDatabase Integration (e2e)
[22m[39mRunning migrations...

[90mstdout[2m | test/database.e2e.spec.ts[2m > [22m[2mDatabase Integration (e2e)
[22m[39m[4mMigration "AddPasswordHashToUsers1733771000001" failed, error: Duplicate column name 'password_hash'[24m


[1m[33m ‚ùØ [39m[22mtest/credit-tiers-integration.e2e.spec.ts[2m 0/21[22m
[1m[33m ‚ùØ [39m[22mtest/database.e2e.spec.ts[2m 1/2[22m
[1m[33m ‚ùØ [39m[22mtest/group-class-booking.e2e.spec.ts[2m 0/2[22m
[1m[33m ‚ùØ [39m[22mtest/payments-session-booking.e2e.spec.ts[2m 0/8[22m
[1m[33m ‚ùØ [39m[22mtest/payments-webhook-group-booking.e2e.spec.ts[2m 0/6[22m
[1m[33m ‚ùØ [39m[22mtest/students-api.e2e.spec.ts[2m 0/3[22m
[1m[33m ‚ùØ [39m[22mtest/teacher-availability.e2e.spec.ts[2m 0/13[22m

[2m Test Files [22m[1m[31m1 failed[39m[22m[2m | [22m[1m[32m0 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[32m10 passed[39m[22m[2m | [22m[33m1 skipped[39m[90m (65)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m5.85s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[90mstdout[2m | test/credit-tiers-integration.e2e.spec.ts[2m > [22m[2mCredit Tier System Integration (e2e)
[22m[39m[4mMigration "AddPasswordHashToUsers1733771000001" failed, error: Duplicate column name 'password_hash'[24m

[90mstdout[2m | test/payments-session-booking.e2e.spec.ts[2m > [22m[2mPaymentsService.createSessionAndBookingFromMetadata (e2e)
[22m[39m[4mMigration "AddPasswordHashToUsers1733771000001" failed, error: Duplicate column name 'password_hash'[24m

[90mstdout[2m | test/teacher-availability.e2e.spec.ts[2m > [22m[2mTeacherAvailabilityService (e2e)
[22m[39m[4mMigration "AddPasswordHashToUsers1733771000001" failed, error: Duplicate column name 'password_hash'[24m

 [31m‚ùØ[39m test/credit-tiers-integration.e2e.spec.ts [2m([22m[2m21 tests[22m[2m | [22m[33m21 skipped[39m[2m)[22m[33m 714[2mms[22m[39m
   [2m[90m‚Üì[39m[22m Credit Tier System Integration (e2e)[2m > [22mGET /packages/compatible-for-session/:sessionId[2m > [22mshould return compatible packages for a private session
   [2m[90m‚Üì[39m[22m Credit Tier System Integration (e2e)[2m > [22mGET /packages/compatible-for-session/:sessionId[2m > [22mshould return both exact and higher-tier packages for group session
   [2m[90m‚Üì[39m[22m Credit Tier System Integration (e2e)[2m > [22mGET /packages/compatible-for-session/:sessionId[2m > [22mshould exclude incompatible packages (group package for private session)
   [2m[90m‚Üì[39m[22m Credit Tier System Integration (e2e)[2m > [22mGET /packages/compatible-for-session/:sessionId[2m > [22mshould exclude expired packages
   [2m[90m‚Üì[39m[22m Credit Tier System Integration (e2e)[2m > [22mGET /packages/compatible-for-session/:sessionId[2m > [22mshould exclude packages with no remaining sessions
   [2m[90m‚Üì[39m[22m Credit Tier System Integration (e2e)[2m > [22mGET /packages/compatible-for-session/:sessionId[2m > [22mshould handle premium teacher sessions correctly
   [2m[90m‚Üì[39m[22m Credit Tier System Integration (e2e)[2m > [22mGET /packages/compatible-for-session/:sessionId[2m > [22mshould return 401 when not authenticated
   [2m[90m‚Üì[39m[22m Credit Tier System Integration (e2e)[2m > [22mGET /packages/compatible-for-session/:sessionId[2m > [22mshould return 404 for non-existent session
   [2m[90m‚Üì[39m[22m Credit Tier System Integration (e2e)[2m > [22mPOST /payments/book-with-package (Tier Validation)[2m > [22mshould allow booking with exact-match package
   [2m[90m‚Üì[39m[22m Credit Tier System Integration (e2e)[2m > [22mPOST /payments/book-with-package (Tier Validation)[2m > [22mshould allow cross-tier booking with confirmation
   [2m[90m‚Üì[39m[22m Credit Tier System Integration (e2e)[2m > [22mPOST /payments/book-with-package (Tier Validation)[2m > [22mshould reject cross-tier booking without confirmation
   [2m[90m‚Üì[39m[22m Credit Tier System Integration (e2e)[2m > [22mPOST /payments/book-with-package (Tier Validation)[2m > [22mshould reject booking group package for private session
   [2m[90m‚Üì[39m[22m Credit Tier System Integration (e2e)[2m > [22mPOST /payments/book-with-package (Tier Validation)[2m > [22mshould calculate correct credits for duration mismatch (60 min session, 30 min credit)
   [2m[90m‚Üì[39m[22m Credit Tier System Integration (e2e)[2m > [22mPOST /payments/book-with-package (Tier Validation)[2m > [22mshould calculate correct credits for duration mismatch (30 min session, 60 min credit)
   [2m[90m‚Üì[39m[22m Credit Tier System Integration (e2e)[2m > [22mPOST /payments/book-with-package (Tier Validation)[2m > [22mshould reject booking when insufficient credits
   [2m[90m‚Üì[39m[22m Credit Tier System Integration (e2e)[2m > [22mPOST /payments/book-with-package (Tier Validation)[2m > [22mshould reject booking with expired package
   [2m[90m‚Üì[39m[22m Credit Tier System Integration (e2e)[2m > [22mPOST /payments/book-with-package (Tier Validation)[2m > [22mshould reject standard package for premium teacher session
   [2m[90m‚Üì[39m[22m Credit Tier System Integration (e2e)[2m > [22mPOST /payments/book-with-package (Tier Validation)[2m > [22mshould allow premium package for standard teacher session with confirmation
   [2m[90m‚Üì[39m[22m Credit Tier System Integration (e2e)[2m > [22mCancellation Refund (Tier System)[2m > [22mshould refund to original package when canceling cross-tier booking
   [2m[90m‚Üì[39m[22m Credit Tier System Integration (e2e)[2m > [22mCancellation Refund (Tier System)[2m > [22mshould refund correct number of credits for duration-based booking
   [2m[90m‚Üì[39m[22m Credit Tier System Integration (e2e)[2m > [22mEdge Cases[2m > [22mshould handle concurrent booking attempts with last credit
 [31m‚ùØ[39m test/database.e2e.spec.ts [2m([22m[2m2 tests[22m[2m | [22m[33m2 skipped[39m[2m)[22m[33m 729[2mms[22m[39m
   [2m[90m‚Üì[39m[22m Database Integration (e2e)[2m > [22mshould connect to test database
   [2m[90m‚Üì[39m[22m Database Integration (e2e)[2m > [22mshould have access to entities
 [31m‚ùØ[39m test/payments-session-booking.e2e.spec.ts [2m([22m[2m8 tests[22m[2m | [22m[33m8 skipped[39m[2m)[22m[33m 733[2mms[22m[39m
   [2m[90m‚Üì[39m[22m PaymentsService.createSessionAndBookingFromMetadata (e2e)[2m > [22mcreateSessionAndBookingFromMetadata[2m > [22mPRIVATE sessions[2m > [22mshould create session and booking in a transaction
   [2m[90m‚Üì[39m[22m PaymentsService.createSessionAndBookingFromMetadata (e2e)[2m > [22mcreateSessionAndBookingFromMetadata[2m > [22mPRIVATE sessions[2m > [22mshould fail if teacher availability validation fails
   [2m[90m‚Üì[39m[22m PaymentsService.createSessionAndBookingFromMetadata (e2e)[2m > [22mcreateSessionAndBookingFromMetadata[2m > [22mGROUP sessions[2m > [22mshould create booking for existing session
   [2m[90m‚Üì[39m[22m PaymentsService.createSessionAndBookingFromMetadata (e2e)[2m > [22mcreateSessionAndBookingFromMetadata[2m > [22mGROUP sessions[2m > [22mshould fail if student does not exist
   [2m[90m‚Üì[39m[22m PaymentsService.createSessionAndBookingFromMetadata (e2e)[2m > [22mcreateSessionAndBookingFromMetadata[2m > [22mGROUP sessions[2m > [22mshould fail if session type mismatch
   [2m[90m‚Üì[39m[22m PaymentsService.createSessionAndBookingFromMetadata (e2e)[2m > [22mcreateSessionAndBookingFromMetadata[2m > [22mCOURSE sessions[2m > [22mshould create booking for existing course session
   [2m[90m‚Üì[39m[22m PaymentsService.createSessionAndBookingFromMetadata (e2e)[2m > [22mcreateSessionAndBookingFromMetadata[2m > [22mError handling[2m > [22mshould handle missing student_id gracefully
   [2m[90m‚Üì[39m[22m PaymentsService.createSessionAndBookingFromMetadata (e2e)[2m > [22mcreateSessionAndBookingFromMetadata[2m > [22mError handling[2m > [22mshould handle invalid service type for session creation
[90mstdout[2m | test/students-api.e2e.spec.ts[2m > [22m[2mStudents API (e2e)
[22m[39m[4mMigration "AddPasswordHashToUsers1733771000001" failed, error: Duplicate column name 'password_hash'[24m

 [31m‚ùØ[39m test/teacher-availability.e2e.spec.ts [2m([22m[2m13 tests[22m[2m | [22m[33m13 skipped[39m[2m)[22m[33m 746[2mms[22m[39m
   [2m[90m‚Üì[39m[22m TeacherAvailabilityService (e2e)[2m > [22mvalidateAvailability[2m > [22mshould validate successfully when teacher has ONE_OFF availability
   [2m[90m‚Üì[39m[22m TeacherAvailabilityService (e2e)[2m > [22mvalidateAvailability[2m > [22mshould validate successfully when teacher has RECURRING availability
   [2m[90m‚Üì[39m[22m TeacherAvailabilityService (e2e)[2m > [22mvalidateAvailability[2m > [22mshould fail when teacher has a blackout during requested time
   [2m[90m‚Üì[39m[22m TeacherAvailabilityService (e2e)[2m > [22mvalidateAvailability[2m > [22mshould fail when teacher has a conflicting booking
   [2m[90m‚Üì[39m[22m TeacherAvailabilityService (e2e)[2m > [22mvalidateAvailability[2m > [22mshould fail when teacher is inactive
   [2m[90m‚Üì[39m[22m TeacherAvailabilityService (e2e)[2m > [22mvalidateAvailability[2m > [22mshould fail when teacher does not exist
   [2m[90m‚Üì[39m[22m TeacherAvailabilityService (e2e)[2m > [22mvalidateAvailability[2m > [22mshould fail when teacher has no availability
   [2m[90m‚Üì[39m[22m TeacherAvailabilityService (e2e)[2m > [22mvalidateAvailability[2m > [22mshould fail when RECURRING availability weekday does not match
   [2m[90m‚Üì[39m[22m TeacherAvailabilityService (e2e)[2m > [22mvalidateAvailability[2m > [22mshould fail when RECURRING availability time does not match
   [2m[90m‚Üì[39m[22m TeacherAvailabilityService (e2e)[2m > [22mpreviewTeacherAvailability (integration)[2m > [22mshould correctly exclude time slots that overlap with scheduled sessions
   [2m[90m‚Üì[39m[22m TeacherAvailabilityService (e2e)[2m > [22mpreviewTeacherAvailability (integration)[2m > [22mshould include full availability when no sessions are scheduled
   [2m[90m‚Üì[39m[22m TeacherAvailabilityService (e2e)[2m > [22mpreviewTeacherAvailability (integration)[2m > [22mshould exclude time slots that overlap with blackouts
   [2m[90m‚Üì[39m[22m TeacherAvailabilityService (e2e)[2m > [22mpreviewTeacherAvailability (integration)[2m > [22mshould handle multiple teachers with different availabilities and bookings
[90mstdout[2m | test/group-class-booking.e2e.spec.ts[2m > [22m[2mGroup Class Booking (e2e)
[22m[39m[4mMigration "AddPasswordHashToUsers1733771000001" failed, error: Duplicate column name 'password_hash'[24m

 [31m‚ùØ[39m test/students-api.e2e.spec.ts [2m([22m[2m3 tests[22m[2m | [22m[33m3 skipped[39m[2m)[22m[33m 418[2mms[22m[39m
   [2m[90m‚Üì[39m[22m Students API (e2e)[2m > [22mGET /api/students/me/upcoming[2m > [22mshould return upcoming sessions with correct teacher name
   [2m[90m‚Üì[39m[22m Students API (e2e)[2m > [22mGET /api/students/me/upcoming[2m > [22mshould respect limit parameter
   [2m[90m‚Üì[39m[22m Students API (e2e)[2m > [22mGET /api/students/me/upcoming[2m > [22mshould return empty array for student with no upcoming sessions
 [31m‚ùØ[39m test/group-class-booking.e2e.spec.ts [2m([22m[2m2 tests[22m[2m | [22m[33m2 skipped[39m[2m)[22m[33m 791[2mms[22m[39m
   [2m[90m‚Üì[39m[22m Group Class Booking (e2e)[2m > [22mPOST /bookings[2m > [22mshould allow a student to book a group class session
   [2m[90m‚Üì[39m[22m Group Class Booking (e2e)[2m > [22mPOST /bookings[2m > [22mshould not allow booking a full group class session

[1m[33m ‚ùØ [39m[22mtest/credit-tiers-integration.e2e.spec.ts[2m 21/21[22m
[1m[33m ‚ùØ [39m[22mtest/database.e2e.spec.ts[2m 2/2[22m
[1m[33m ‚ùØ [39m[22mtest/group-class-booking.e2e.spec.ts[2m 2/2[22m
[1m[33m ‚ùØ [39m[22mtest/payments-session-booking.e2e.spec.ts[2m 8/8[22m
[1m[33m ‚ùØ [39m[22mtest/payments-webhook-group-booking.e2e.spec.ts[2m 0/6[22m
[1m[33m ‚ùØ [39m[22mtest/students-api.e2e.spec.ts[2m 3/3[22m
[1m[33m ‚ùØ [39m[22mtest/teacher-availability.e2e.spec.ts[2m 13/13[22m

[2m Test Files [22m[1m[31m7 failed[39m[22m[2m | [22m[1m[32m0 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[32m10 passed[39m[22m[2m | [22m[33m49 skipped[39m[90m (65)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m5.95s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K
[1m[33m ‚ùØ [39m[22mtest/course-cohort-enrollment.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/database.e2e.spec.ts[2m 2/2[22m
[1m[33m ‚ùØ [39m[22mtest/group-class-booking.e2e.spec.ts[2m 2/2[22m
[1m[33m ‚ùØ [39m[22mtest/payments-session-booking.e2e.spec.ts[2m 8/8[22m
[1m[33m ‚ùØ [39m[22mtest/payments-webhook-group-booking.e2e.spec.ts[2m 0/6[22m
[1m[33m ‚ùØ [39m[22mtest/students-api.e2e.spec.ts[2m 3/3[22m
[1m[33m ‚ùØ [39m[22mtest/teacher-availability.e2e.spec.ts[2m 13/13[22m

[2m Test Files [22m[1m[31m7 failed[39m[22m[2m | [22m[1m[32m0 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[32m10 passed[39m[22m[2m | [22m[33m49 skipped[39m[90m (65)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m6.06s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[90mstdout[2m | test/auth-google-start.e2e.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | test/auth-google-start.e2e.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.

[90mstdout[2m | test/waitlist.e2e.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | test/waitlist.e2e.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.

[90mstdout[2m | test/app.e2e.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | test/app.e2e.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.

[90mstdout[2m | test/course-cohort-enrollment.e2e.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | test/course-cohort-enrollment.e2e.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.

[90mstdout[2m | test/package-booking.e2e.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | test/package-booking.e2e.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.

[90mstdout[2m | test/database-connection.e2e.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | test/database-connection.e2e.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.

[90mstdout[2m | test/payments-webhook-group-booking.e2e.spec.ts[2m > [22m[2mPaymentsService - Group Session Booking via Package Purchase Webhook
[22m[39m‚úì Migration complete:
  - Created 0 package allowances


[1m[33m ‚ùØ [39m[22mtest/app.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/course-cohort-enrollment.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/database-connection.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/package-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/payments-webhook-group-booking.e2e.spec.ts[2m 0/6[22m
[1m[33m ‚ùØ [39m[22mtest/waitlist.e2e.spec.ts[2m [queued][22m

[2m Test Files [22m[1m[31m7 failed[39m[22m[2m | [22m[1m[32m0 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[32m10 passed[39m[22m[2m | [22m[33m49 skipped[39m[90m (65)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m6.98s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K
[1m[33m ‚ùØ [39m[22mtest/app.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/course-cohort-enrollment.e2e.spec.ts[2m 0/6[22m
[1m[33m ‚ùØ [39m[22mtest/database-connection.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/package-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/payments-webhook-group-booking.e2e.spec.ts[2m 0/6[22m
[1m[33m ‚ùØ [39m[22mtest/waitlist.e2e.spec.ts[2m [queued][22m

[2m Test Files [22m[1m[31m7 failed[39m[22m[2m | [22m[1m[32m0 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[32m10 passed[39m[22m[2m | [22m[33m49 skipped[39m[90m (71)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m7.28s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[90mstdout[2m | test/course-cohort-enrollment.e2e.spec.ts[2m > [22m[2mCourse Cohort Enrollment (e2e)
[22m[39m
[TEST SETUP] Running database migrations...

MigrationTestDataSource.options: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  entities: [],
  migrations: [
    [36m[class InitialSchema1733770000000][39m,
    [36m[class AddPasswordHashToUsers1733771000001][39m,
    [36m[class AddTeacherAndAvailability1733772000002][39m,
    [36m[class AddAdminTable1756431459155][39m,
    [36m[class AddStudentTable1756431459156][39m,
    [36m[class AddSchedulingTables1756431459157][39m,
    [36m[class AddWaitlistTable1756431459158][39m,
    [36m[class AddPricingSystemTables1756431459159][39m,
    [36m[class RenameToStripeProductMap1756431459160][39m,
    [36m[class AddDraftStatuses1756431459161][39m,
    [36m[class AddStudentPackagesTables1759000000000][39m,
    [36m[class AddPackageFieldsToBooking1759000000001][39m,
    [36m[class AddCancellationPolicies1759000000002][39m,
    [36m[class AddGroupClassesTables1759000000003][39m,
    [36m[class AddTeacherProfileFields1759000000004][39m,
    [36m[class GroupClassMultipleLevels1759000000005][39m,
    [36m[class AddCourseProgramsTables1760000000000][39m,
    [36m[class AddServiceTypeAndTeacherTierToStripeProductMap1762000000000][39m,
    [36m[class BundlePackagesMigration1762000000010][39m,
    [36m[class AddStripeProductMapFKToStudentPackage1762000000020][39m,
    [36m[class AddPackageUseIdToBooking1762000000030][39m,
    [36m[class AddAllowanceIdToPackageUse1762000000040][39m,
    [36m[class RemoveLegacyCourseTables1762000000050][39m,
    [36m[class SimplifyCourseProgramSchema1763000000000][39m,
    [36m[class AddCourseProgramLevels1764000000000][39m,
    [36m[class AddCourseCohorts1765000000000][39m,
    [36m[class RemoveGroupClassRruleFields1766000000000][39m
  ],
  synchronize: [33mfalse[39m,
  dropSchema: [33mtrue[39m,
  logging: [33mfalse[39m
}
Target DB for migrations: wordpress_test
Initializing MigrationTestDataSource...


[1m[33m ‚ùØ [39m[22mtest/app.e2e.spec.ts[2m 0/1[22m
[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/course-cohort-enrollment.e2e.spec.ts[2m 0/6[22m
[1m[33m ‚ùØ [39m[22mtest/database-connection.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/package-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/payments-webhook-group-booking.e2e.spec.ts[2m 0/6[22m
[1m[33m ‚ùØ [39m[22mtest/waitlist.e2e.spec.ts[2m [queued][22m

[2m Test Files [22m[1m[31m7 failed[39m[22m[2m | [22m[1m[32m0 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[32m10 passed[39m[22m[2m | [22m[33m49 skipped[39m[90m (72)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m7.48s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[90mstdout[2m | test/app.e2e.spec.ts[2m > [22m[2mAppController (e2e)[2m > [22m[2m/ (GET)
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test

[90mstdout[2m | test/payments-webhook-group-booking.e2e.spec.ts[2m > [22m[2mPaymentsService - Group Session Booking via Package Purchase Webhook
[22m[39m[4mMigration "AddCourseCohorts1765000000000" failed, error: Can't create table `wordpress_test`.`course_cohort` (errno: 150 "Foreign key constraint is incorrectly formed")[24m


[1m[33m ‚ùØ [39m[22mtest/app.e2e.spec.ts[2m 0/1[22m
[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/course-cohort-enrollment.e2e.spec.ts[2m 0/6[22m
[1m[33m ‚ùØ [39m[22mtest/database-connection.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/package-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/payments-webhook-group-booking.e2e.spec.ts[2m 1/6[22m
[1m[33m ‚ùØ [39m[22mtest/waitlist.e2e.spec.ts[2m [queued][22m

[2m Test Files [22m[1m[31m7 failed[39m[22m[2m | [22m[1m[32m0 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[32m10 passed[39m[22m[2m | [22m[33m50 skipped[39m[90m (72)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m7.58s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K [31m‚ùØ[39m test/payments-webhook-group-booking.e2e.spec.ts [2m([22m[2m6 tests[22m[2m | [22m[33m6 skipped[39m[2m)[22m[33m 2452[2mms[22m[39m
   [2m[90m‚Üì[39m[22m PaymentsService - Group Session Booking via Package Purchase Webhook[2m > [22mhandlePaymentIntentSucceeded with group session booking metadata[2m > [22mshould promote PENDING booking to CONFIRMED when payment has booking_id and session_id
   [2m[90m‚Üì[39m[22m PaymentsService - Group Session Booking via Package Purchase Webhook[2m > [22mhandlePaymentIntentSucceeded with group session booking metadata[2m > [22mshould handle webhook when booking_id already points to CONFIRMED booking (idempotency)
   [2m[90m‚Üì[39m[22m PaymentsService - Group Session Booking via Package Purchase Webhook[2m > [22mhandlePaymentIntentSucceeded with group session booking metadata[2m > [22mshould not process if session is not found
   [2m[90m‚Üì[39m[22m PaymentsService - Group Session Booking via Package Purchase Webhook[2m > [22mhandlePaymentIntentSucceeded with group session booking metadata[2m > [22mshould promote session from DRAFT to SCHEDULED along with booking
   [2m[90m‚Üì[39m[22m PaymentsService - Group Session Booking via Package Purchase Webhook[2m > [22mhandlePaymentIntentSucceeded with group session booking metadata[2m > [22mshould handle metadata with empty start_at/end_at for group bookings
   [2m[90m‚Üì[39m[22m PaymentsService - Group Session Booking via Package Purchase Webhook[2m > [22mhandlePaymentIntentSucceeded with group session booking metadata[2m > [22mshould create PackageUse record and deduct credits when promoting booking
[90mstdout[2m | test/course-cohort-enrollment.e2e.spec.ts[2m > [22m[2mCourse Cohort Enrollment (e2e)
[22m[39mRunning migrations...

[90mstdout[2m | test/app.e2e.spec.ts[2m > [22m[2mAppController (e2e)[2m > [22m[2m/ (GET)
[22m[39m[AppModule] Loaded 27 entities directly via import

[90mstdout[2m | test/waitlist.e2e.spec.ts[2m > [22m[2mWaitlist (e2e)[2m > [22m[2mshould allow a student to join a waitlist for a full group class session
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test

[90mstdout[2m | test/auth-google-start.e2e.spec.ts[2m > [22m[2mAuth Google Start Redirect (e2e)
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test


[1m[33m ‚ùØ [39m[22msrc/sessions/services/sessions.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/app.e2e.spec.ts[2m 0/1[22m
[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m 0/3[22m
[1m[33m ‚ùØ [39m[22mtest/course-cohort-enrollment.e2e.spec.ts[2m 0/6[22m
[1m[33m ‚ùØ [39m[22mtest/database-connection.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/package-booking.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/waitlist.e2e.spec.ts[2m 0/4[22m

[2m Test Files [22m[1m[31m8 failed[39m[22m[2m | [22m[1m[32m0 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[32m10 passed[39m[22m[2m | [22m[33m55 skipped[39m[90m (79)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m7.68s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[90mstdout[2m | test/package-booking.e2e.spec.ts[2m > [22m[2mPackage Booking (e2e)
[22m[39m
[TEST SETUP] Running database migrations...

MigrationTestDataSource.options: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  entities: [],
  migrations: [
    [36m[class InitialSchema1733770000000][39m,
    [36m[class AddPasswordHashToUsers1733771000001][39m,
    [36m[class AddTeacherAndAvailability1733772000002][39m,
    [36m[class AddAdminTable1756431459155][39m,
    [36m[class AddStudentTable1756431459156][39m,
    [36m[class AddSchedulingTables1756431459157][39m,
    [36m[class AddWaitlistTable1756431459158][39m,
    [36m[class AddPricingSystemTables1756431459159][39m,
    [36m[class RenameToStripeProductMap1756431459160][39m,
    [36m[class AddDraftStatuses1756431459161][39m,
    [36m[class AddStudentPackagesTables1759000000000][39m,
    [36m[class AddPackageFieldsToBooking1759000000001][39m,
    [36m[class AddCancellationPolicies1759000000002][39m,
    [36m[class AddGroupClassesTables1759000000003][39m,
    [36m[class AddTeacherProfileFields1759000000004][39m,
    [36m[class GroupClassMultipleLevels1759000000005][39m,
    [36m[class AddCourseProgramsTables1760000000000][39m,
    [36m[class AddServiceTypeAndTeacherTierToStripeProductMap1762000000000][39m,
    [36m[class BundlePackagesMigration1762000000010][39m,
    [36m[class AddStripeProductMapFKToStudentPackage1762000000020][39m,
    [36m[class AddPackageUseIdToBooking1762000000030][39m,
    [36m[class AddAllowanceIdToPackageUse1762000000040][39m,
    [36m[class RemoveLegacyCourseTables1762000000050][39m,
    [36m[class SimplifyCourseProgramSchema1763000000000][39m,
    [36m[class AddCourseProgramLevels1764000000000][39m,
    [36m[class AddCourseCohorts1765000000000][39m,
    [36m[class RemoveGroupClassRruleFields1766000000000][39m
  ],
  synchronize: [33mfalse[39m,
  dropSchema: [33mtrue[39m,
  logging: [33mfalse[39m
}
Target DB for migrations: wordpress_test
Initializing MigrationTestDataSource...

[90mstdout[2m | test/auth-google-start.e2e.spec.ts[2m > [22m[2mAuth Google Start Redirect (e2e)
[22m[39m[AppModule] Loaded 27 entities directly via import

[90mstdout[2m | test/waitlist.e2e.spec.ts[2m > [22m[2mWaitlist (e2e)[2m > [22m[2mshould allow a student to join a waitlist for a full group class session
[22m[39m[AppModule] Loaded 27 entities directly via import

[90mstdout[2m | test/course-cohort-enrollment.e2e.spec.ts[2m > [22m[2mCourse Cohort Enrollment (e2e)
[22m[39m[4mMigration "AddStudentPackagesTables1759000000000" failed, error: Can't create table `wordpress_test`.`student_package` (errno: 150 "Foreign key constraint is incorrectly formed")[24m


[1m[33m ‚ùØ [39m[22msrc/sessions/services/sessions.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/app.e2e.spec.ts[2m 0/1[22m
[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m 0/3[22m
[1m[33m ‚ùØ [39m[22mtest/course-cohort-enrollment.e2e.spec.ts[2m 1/6[22m
[1m[33m ‚ùØ [39m[22mtest/database-connection.e2e.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/package-booking.e2e.spec.ts[2m 0/9[22m
[1m[33m ‚ùØ [39m[22mtest/waitlist.e2e.spec.ts[2m 0/4[22m

[2m Test Files [22m[1m[31m8 failed[39m[22m[2m | [22m[1m[32m0 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[32m10 passed[39m[22m[2m | [22m[33m56 skipped[39m[90m (88)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m7.78s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K [31m‚ùØ[39m test/course-cohort-enrollment.e2e.spec.ts [2m([22m[2m6 tests[22m[2m | [22m[33m6 skipped[39m[2m)[22m[33m 506[2mms[22m[39m
   [2m[90m‚Üì[39m[22m Course Cohort Enrollment (e2e)[2m > [22mPOST /api/course-programs/:code/cohorts/:cohortId/enroll[2m > [22mshould successfully enroll a student in a cohort
   [2m[90m‚Üì[39m[22m Course Cohort Enrollment (e2e)[2m > [22mPOST /api/course-programs/:code/cohorts/:cohortId/enroll[2m > [22mshould return 401 when not authenticated
   [2m[90m‚Üì[39m[22m Course Cohort Enrollment (e2e)[2m > [22mPOST /api/course-programs/:code/cohorts/:cohortId/enroll[2m > [22mshould return 404 when cohort does not exist
   [2m[90m‚Üì[39m[22m Course Cohort Enrollment (e2e)[2m > [22mPOST /api/course-programs/:code/cohorts/:cohortId/enroll[2m > [22mshould return 404 when course code does not match
   [2m[90m‚Üì[39m[22m Course Cohort Enrollment (e2e)[2m > [22mGET /api/course-programs/:code/cohorts/:cohortId (cohort detail)[2m > [22mshould return cohort details with sessions
   [2m[90m‚Üì[39m[22m Course Cohort Enrollment (e2e)[2m > [22mGET /api/course-programs/:code/cohorts/:cohortId (cohort detail)[2m > [22mshould return 404 when cohort does not exist
[90mstdout[2m | test/package-booking.e2e.spec.ts[2m > [22m[2mPackage Booking (e2e)
[22m[39mRunning migrations...

[90mstdout[2m | test/database-connection.e2e.spec.ts[2m > [22m[2mDatabase Connection (e2e)
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test

[90mstdout[2m | test/auth-google-start.e2e.spec.ts[2m > [22m[2mAuth Google Start Redirect (e2e)
[22m[39m
[TEST SETUP] Running database migrations...

MigrationTestDataSource.options: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  entities: [],
  migrations: [
    [36m[class InitialSchema1733770000000][39m,
    [36m[class AddPasswordHashToUsers1733771000001][39m,
    [36m[class AddTeacherAndAvailability1733772000002][39m,
    [36m[class AddAdminTable1756431459155][39m,
    [36m[class AddStudentTable1756431459156][39m,
    [36m[class AddSchedulingTables1756431459157][39m,
    [36m[class AddWaitlistTable1756431459158][39m,
    [36m[class AddPricingSystemTables1756431459159][39m,
    [36m[class RenameToStripeProductMap1756431459160][39m,
    [36m[class AddDraftStatuses1756431459161][39m,
    [36m[class AddStudentPackagesTables1759000000000][39m,
    [36m[class AddPackageFieldsToBooking1759000000001][39m,
    [36m[class AddCancellationPolicies1759000000002][39m,
    [36m[class AddGroupClassesTables1759000000003][39m,
    [36m[class AddTeacherProfileFields1759000000004][39m,
    [36m[class GroupClassMultipleLevels1759000000005][39m,
    [36m[class AddCourseProgramsTables1760000000000][39m,
    [36m[class AddServiceTypeAndTeacherTierToStripeProductMap1762000000000][39m,
    [36m[class BundlePackagesMigration1762000000010][39m,
    [36m[class AddStripeProductMapFKToStudentPackage1762000000020][39m,
    [36m[class AddPackageUseIdToBooking1762000000030][39m,
    [36m[class AddAllowanceIdToPackageUse1762000000040][39m,
    [36m[class RemoveLegacyCourseTables1762000000050][39m,
    [36m[class SimplifyCourseProgramSchema1763000000000][39m,
    [36m[class AddCourseProgramLevels1764000000000][39m,
    [36m[class AddCourseCohorts1765000000000][39m,
    [36m[class RemoveGroupClassRruleFields1766000000000][39m
  ],
  synchronize: [33mfalse[39m,
  dropSchema: [33mtrue[39m,
  logging: [33mfalse[39m
}
Target DB for migrations: wordpress_test
Initializing MigrationTestDataSource...

[90mstdout[2m | test/auth-google-start.e2e.spec.ts[2m > [22m[2mAuth Google Start Redirect (e2e)
[22m[39mRunning migrations...

[90mstdout[2m | test/database-connection.e2e.spec.ts[2m > [22m[2mDatabase Connection (e2e)
[22m[39m[AppModule] Loaded 27 entities directly via import


[1m[33m ‚ùØ [39m[22msrc/sessions/services/sessions.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/app.e2e.spec.ts[2m 0/1[22m
[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m 0/3[22m
[1m[33m ‚ùØ [39m[22mtest/course-cohort-enrollment.e2e.spec.ts[2m 6/6[22m
[1m[33m ‚ùØ [39m[22mtest/database-connection.e2e.spec.ts[2m 0/1[22m
[1m[33m ‚ùØ [39m[22mtest/package-booking.e2e.spec.ts[2m 1/9[22m
[1m[33m ‚ùØ [39m[22mtest/waitlist.e2e.spec.ts[2m 0/4[22m

[2m Test Files [22m[1m[31m9 failed[39m[22m[2m | [22m[1m[32m0 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[32m10 passed[39m[22m[2m | [22m[33m62 skipped[39m[90m (89)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m7.99s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K [31m‚ùØ[39m test/package-booking.e2e.spec.ts [2m([22m[2m9 tests[22m[2m | [22m[33m9 skipped[39m[2m)[22m[32m 211[2mms[22m[39m
   [2m[90m‚Üì[39m[22m Package Booking (e2e)[2m > [22mGET /packages/my-credits[2m > [22mshould return student credits
   [2m[90m‚Üì[39m[22m Package Booking (e2e)[2m > [22mGET /packages/my-credits[2m > [22mshould return 401 when user not authenticated
   [2m[90m‚Üì[39m[22m Package Booking (e2e)[2m > [22mPOST /payments/book-with-package[2m > [22mshould successfully book session with package credit
   [2m[90m‚Üì[39m[22m Package Booking (e2e)[2m > [22mPOST /payments/book-with-package[2m > [22mshould return 400 when package has no remaining sessions
   [2m[90m‚Üì[39m[22m Package Booking (e2e)[2m > [22mPOST /payments/book-with-package[2m > [22mshould return 404 when package not found
   [2m[90m‚Üì[39m[22m Package Booking (e2e)[2m > [22mPOST /payments/book-with-package[2m > [22mshould return 400 when package is expired
   [2m[90m‚Üì[39m[22m Package Booking (e2e)[2m > [22mPOST /payments/book-with-package[2m > [22mshould return 400 with invalid request body
   [2m[90m‚Üì[39m[22m Package Booking (e2e)[2m > [22mPOST /packages/:id/use with bookingData[2m > [22mshould successfully create session and book with package
   [2m[90m‚Üì[39m[22m Package Booking (e2e)[2m > [22mConcurrency test for POST /bookings[2m > [22mshould handle concurrent booking requests correctly
 [32m‚úì[39m test/app.e2e.spec.ts [2m([22m[2m1 test[22m[2m)[22m[33m 524[2mms[22m[39m
   [33m[2m‚úì[22m[39m AppController (e2e)[2m > [22m/ (GET) [33m 510[2mms[22m[39m
[90mstdout[2m | test/waitlist.e2e.spec.ts[2m > [22m[2mWaitlist (e2e)[2m > [22m[2mshould not allow a student to join a waitlist for a session that is not full
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test

[90mstdout[2m | test/waitlist.e2e.spec.ts[2m > [22m[2mWaitlist (e2e)[2m > [22m[2mshould not allow a student to join a waitlist for a session that is not full
[22m[39m[AppModule] Loaded 27 entities directly via import


[1m[33m ‚ùØ [39m[22msrc/auth/auth.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/packages/packages.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/sessions/services/sessions.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/app.e2e.spec.ts[2m 1/1[22m
[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m 0/3[22m
[1m[33m ‚ùØ [39m[22mtest/database-connection.e2e.spec.ts[2m 0/1[22m
[1m[33m ‚ùØ [39m[22mtest/waitlist.e2e.spec.ts[2m 0/4[22m

[2m Test Files [22m[1m[31m10 failed[39m[22m[2m | [22m[1m[32m1 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[32m11 passed[39m[22m[2m | [22m[33m70 skipped[39m[90m (89)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m8.19s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K
[1m[33m ‚ùØ [39m[22msrc/auth/auth.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/packages/packages.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/sessions/services/sessions.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/waitlists/waitlists.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m 0/3[22m
[1m[33m ‚ùØ [39m[22mtest/database-connection.e2e.spec.ts[2m 1/1[22m
[1m[33m ‚ùØ [39m[22mtest/waitlist.e2e.spec.ts[2m 1/4[22m

[2m Test Files [22m[1m[31m10 failed[39m[22m[2m | [22m[1m[32m1 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[31m1 failed[39m[22m[2m | [22m[1m[32m12 passed[39m[22m[2m | [22m[33m70 skipped[39m[90m (89)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m8.29s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K [32m‚úì[39m test/database-connection.e2e.spec.ts [2m([22m[2m1 test[22m[2m)[22m[33m 453[2mms[22m[39m
[90mstdout[2m | src/sessions/services/sessions.service.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | src/sessions/services/sessions.service.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.

[90mstdout[2m | src/packages/packages.service.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | src/packages/packages.service.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.


[1m[33m ‚ùØ [39m[22msrc/auth/auth.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/packages/packages.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/sessions/services/sessions.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/users/users.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/waitlists/waitlists.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m 0/3[22m
[1m[33m ‚ùØ [39m[22mtest/waitlist.e2e.spec.ts[2m 1/4[22m

[2m Test Files [22m[1m[31m10 failed[39m[22m[2m | [22m[1m[32m2 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[31m1 failed[39m[22m[2m | [22m[1m[32m12 passed[39m[22m[2m | [22m[33m70 skipped[39m[90m (89)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m8.49s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[90mstdout[2m | test/waitlist.e2e.spec.ts[2m > [22m[2mWaitlist (e2e)[2m > [22m[2mwhen a booking is cancelled, the first student on the waitlist is notified
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test

[90mstdout[2m | test/waitlist.e2e.spec.ts[2m > [22m[2mWaitlist (e2e)[2m > [22m[2mwhen a booking is cancelled, the first student on the waitlist is notified
[22m[39m[AppModule] Loaded 27 entities directly via import

[90mstdout[2m | src/waitlists/waitlists.service.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | src/waitlists/waitlists.service.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.

[90mstdout[2m | src/auth/auth.service.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | src/auth/auth.service.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.


[1m[33m ‚ùØ [39m[22msrc/auth/auth.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/packages/packages.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/sessions/services/sessions.service.spec.ts[2m 0/8[22m
[1m[33m ‚ùØ [39m[22msrc/users/users.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/waitlists/waitlists.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m 0/3[22m
[1m[33m ‚ùØ [39m[22mtest/waitlist.e2e.spec.ts[2m 1/4[22m

[2m Test Files [22m[1m[31m10 failed[39m[22m[2m | [22m[1m[32m2 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[31m1 failed[39m[22m[2m | [22m[1m[32m12 passed[39m[22m[2m | [22m[33m70 skipped[39m[90m (97)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m8.69s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[90mstdout[2m | src/sessions/services/sessions.service.spec.ts[2m > [22m[2mSessionsService[2m > [22m[2mvalidateAvailability[2m > [22m[2mshould throw BadRequestException on database error
[22m[39mError validating session: Error: Database connection failed
    at [90m/Users/davidcook/personal/thrive-wp/apps/nestjs/[39msrc/sessions/services/sessions.service.spec.ts:189:9
    at file:///Users/davidcook/personal/thrive-wp/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:155:11
    at file:///Users/davidcook/personal/thrive-wp/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:752:26
    at file:///Users/davidcook/personal/thrive-wp/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///Users/davidcook/personal/thrive-wp/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:1863:10)
    at runTest (file:///Users/davidcook/personal/thrive-wp/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:1574:12)
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite (file:///Users/davidcook/personal/thrive-wp/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (file:///Users/davidcook/personal/thrive-wp/node_modules/[4m@vitest[24m/runner/dist/chunk-hooks.js:1729:8)

 [32m‚úì[39m src/sessions/services/sessions.service.spec.ts [2m([22m[2m8 tests[22m[2m)[22m[32m 36[2mms[22m[39m
[90mstdout[2m | src/users/users.service.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | src/users/users.service.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.


[1m[33m ‚ùØ [39m[22msrc/auth/auth.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/group-classes/group-classes.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/packages/packages.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/users/users.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/waitlists/waitlists.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m 0/3[22m
[1m[33m ‚ùØ [39m[22mtest/waitlist.e2e.spec.ts[2m 2/4[22m

[2m Test Files [22m[1m[31m10 failed[39m[22m[2m | [22m[1m[32m3 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[31m2 failed[39m[22m[2m | [22m[1m[32m20 passed[39m[22m[2m | [22m[33m70 skipped[39m[90m (97)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m8.89s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[90mstdout[2m | src/packages/packages.service.spec.ts[2m > [22m[2mPackagesService[2m > [22m[2mgetActivePackagesForStudent[2m > [22m[2mshould return active packages for a student
[22m[39mFetching active packages for student [33m1[39m

[90mstdout[2m | src/packages/packages.service.spec.ts[2m > [22m[2mPackagesService[2m > [22m[2mgetActivePackagesForStudent[2m > [22m[2mshould return active packages for a student
[22m[39mwithremaining [
  {
    id: [33m1[39m,
    packageName: [32m'5-class pack'[39m,
    totalSessions: [33m5[39m,
    remainingSessions: [33m3[39m,
    purchasedAt: [32m'2025-11-08T21:32:46.616Z'[39m,
    expiresAt: [32m'2025-11-09T21:32:46.616Z'[39m,
    allowances: [ [36m[Object][39m ]
  }
]

[90mstdout[2m | src/packages/packages.service.spec.ts[2m > [22m[2mPackagesService[2m > [22m[2mgetActivePackagesForStudent[2m > [22m[2mshould filter out expired packages
[22m[39mFetching active packages for student [33m1[39m

[90mstdout[2m | src/packages/packages.service.spec.ts[2m > [22m[2mPackagesService[2m > [22m[2mgetActivePackagesForStudent[2m > [22m[2mshould filter out expired packages
[22m[39mwithremaining []

[90mstdout[2m | src/packages/packages.service.spec.ts[2m > [22m[2mPackagesService[2m > [22m[2mgetActivePackagesForStudent[2m > [22m[2mshould filter out packages with no remaining sessions
[22m[39mFetching active packages for student [33m1[39m

[90mstdout[2m | src/packages/packages.service.spec.ts[2m > [22m[2mPackagesService[2m > [22m[2mgetActivePackagesForStudent[2m > [22m[2mshould filter out packages with no remaining sessions
[22m[39mwithremaining [
  {
    id: [33m1[39m,
    packageName: [32m'Used up pack'[39m,
    totalSessions: [33m5[39m,
    remainingSessions: [33m0[39m,
    purchasedAt: [32m'2025-11-08T21:32:46.628Z'[39m,
    expiresAt: [1mnull[22m,
    allowances: [ [36m[Object][39m ]
  }
]

 [32m‚úì[39m src/packages/packages.service.spec.ts [2m([22m[2m10 tests[22m[2m)[22m[32m 57[2mms[22m[39m

[1m[33m ‚ùØ [39m[22msrc/auth/auth.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/group-classes/group-classes.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/packages/packages.service.spec.ts[2m 10/10[22m
[1m[33m ‚ùØ [39m[22msrc/users/users.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/waitlists/waitlists.service.spec.ts[2m 0/11[22m
[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m 0/3[22m
[1m[33m ‚ùØ [39m[22mtest/waitlist.e2e.spec.ts[2m 2/4[22m

[2m Test Files [22m[1m[31m10 failed[39m[22m[2m | [22m[1m[32m4 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[31m2 failed[39m[22m[2m | [22m[1m[32m30 passed[39m[22m[2m | [22m[33m70 skipped[39m[90m (118)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m9.10s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[90mstdout[2m | src/waitlists/waitlists.service.spec.ts[2m > [22m[2mWaitlistsService[2m > [22m[2mnotifyWaitlistMember[2m > [22m[2mshould update notifiedAt and notificationExpiresAt fields
[22m[39mNotifying student 1 about opening in session 1

[90mstdout[2m | src/waitlists/waitlists.service.spec.ts[2m > [22m[2mWaitlistsService[2m > [22m[2mhandleBookingCancellation[2m > [22m[2mshould notify first waitlist member when booking is cancelled
[22m[39mNotifying student 1 about opening in session undefined

 [32m‚úì[39m src/waitlists/waitlists.service.spec.ts [2m([22m[2m11 tests[22m[2m)[22m[32m 47[2mms[22m[39m

[1m[33m ‚ùØ [39m[22msrc/auth/auth.service.spec.ts[2m 0/5[22m
[1m[33m ‚ùØ [39m[22msrc/group-classes/group-classes.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/packages/packages.service.spec.ts[2m 10/10[22m
[1m[33m ‚ùØ [39m[22msrc/users/users.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/waitlists/waitlists.service.spec.ts[2m 11/11[22m
[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m 0/3[22m
[1m[33m ‚ùØ [39m[22mtest/waitlist.e2e.spec.ts[2m 2/4[22m

[2m Test Files [22m[1m[31m10 failed[39m[22m[2m | [22m[1m[32m5 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[31m2 failed[39m[22m[2m | [22m[1m[32m41 passed[39m[22m[2m | [22m[33m70 skipped[39m[90m (123)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m9.30s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K [32m‚úì[39m src/auth/auth.service.spec.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 13[2mms[22m[39m
[90mstdout[2m | test/auth-google-start.e2e.spec.ts[2m > [22m[2mAuth Google Start Redirect (e2e)
[22m[39m‚úì Migration complete:
  - Created 0 package allowances

[90mstdout[2m | src/group-classes/group-classes.service.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | src/group-classes/group-classes.service.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.


[1m[33m ‚ùØ [39m[22msrc/app.controller.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/common/types/credit-tiers.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/group-classes/group-classes.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/payments/payments.controller.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/users/users.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m 0/3[22m
[1m[33m ‚ùØ [39m[22mtest/waitlist.e2e.spec.ts[2m 2/4[22m

[2m Test Files [22m[1m[31m10 failed[39m[22m[2m | [22m[1m[32m6 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[31m2 failed[39m[22m[2m | [22m[1m[32m46 passed[39m[22m[2m | [22m[33m70 skipped[39m[90m (123)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m9.40s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[90mstdout[2m | test/waitlist.e2e.spec.ts[2m > [22m[2mWaitlist (e2e)[2m > [22m[2madmin can promote a student from the waitlist to a booking
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test

[90mstdout[2m | test/waitlist.e2e.spec.ts[2m > [22m[2mWaitlist (e2e)[2m > [22m[2madmin can promote a student from the waitlist to a booking
[22m[39m[AppModule] Loaded 27 entities directly via import


[1m[33m ‚ùØ [39m[22msrc/app.controller.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/common/types/credit-tiers.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/group-classes/group-classes.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/payments/payments.controller.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/users/users.service.spec.ts[2m 0/10[22m
[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m 0/3[22m
[1m[33m ‚ùØ [39m[22mtest/waitlist.e2e.spec.ts[2m 3/4[22m

[2m Test Files [22m[1m[31m10 failed[39m[22m[2m | [22m[1m[32m6 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[31m3 failed[39m[22m[2m | [22m[1m[32m46 passed[39m[22m[2m | [22m[33m70 skipped[39m[90m (133)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m9.60s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K [32m‚úì[39m src/users/users.service.spec.ts [2m([22m[2m10 tests[22m[2m)[22m[32m 35[2mms[22m[39m

[1m[33m ‚ùØ [39m[22msrc/app.controller.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/common/types/credit-tiers.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/group-classes/group-classes.service.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/payments/payments.controller.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/users/users.service.spec.ts[2m 10/10[22m
[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m 0/3[22m
[1m[33m ‚ùØ [39m[22mtest/waitlist.e2e.spec.ts[2m 3/4[22m

[2m Test Files [22m[1m[31m10 failed[39m[22m[2m | [22m[1m[32m7 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[31m3 failed[39m[22m[2m | [22m[1m[32m56 passed[39m[22m[2m | [22m[33m70 skipped[39m[90m (133)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m9.94s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[90mstdout[2m | src/common/types/credit-tiers.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | src/common/types/credit-tiers.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.

[90mstdout[2m | src/payments/payments.controller.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | src/payments/payments.controller.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.

[90mstdout[2m | src/app.controller.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | src/app.controller.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.


[1m[33m ‚ùØ [39m[22msrc/app.controller.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/common/types/credit-tiers.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/group-classes/group-classes.service.spec.ts[2m 0/5[22m
[1m[33m ‚ùØ [39m[22msrc/payments/payments.controller.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22msrc/teachers/entities/teacher-availability.entity.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m 0/3[22m
[1m[33m ‚ùØ [39m[22mtest/waitlist.e2e.spec.ts[2m 3/4[22m

[2m Test Files [22m[1m[31m10 failed[39m[22m[2m | [22m[1m[32m7 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[31m3 failed[39m[22m[2m | [22m[1m[32m56 passed[39m[22m[2m | [22m[33m70 skipped[39m[90m (138)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m10.14s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K [32m‚úì[39m src/group-classes/group-classes.service.spec.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 14[2mms[22m[39m
 [32m‚úì[39m src/payments/payments.controller.spec.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 5[2mms[22m[39m
 [32m‚úì[39m src/common/types/credit-tiers.spec.ts [2m([22m[2m54 tests[22m[2m)[22m[32m 8[2mms[22m[39m


[1m[33m ‚ùØ [39m[22msrc/app.controller.spec.ts[2m 1/1[22m
[1m[33m ‚ùØ [39m[22msrc/group-classes/group-classes.service.spec.ts[2m 5/5[22m
[1m[33m ‚ùØ [39m[22msrc/teachers/entities/teacher-availability.entity.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m 0/3[22m
[1m[33m ‚ùØ [39m[22mtest/waitlist.e2e.spec.ts[2m 3/4[22m

[2m Test Files [22m[1m[31m10 failed[39m[22m[2m | [22m[1m[32m10 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[31m3 failed[39m[22m[2m | [22m[1m[32m121 passed[39m[22m[2m | [22m[33m70 skipped[39m[90m (198)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m10.24s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K [32m‚úì[39m src/app.controller.spec.ts [2m([22m[2m1 test[22m[2m)[22m[32m 6[2mms[22m[39m
[90mstdout[2m | src/teachers/entities/teacher-availability.entity.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | src/teachers/entities/teacher-availability.entity.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.


[1m[33m ‚ùØ [39m[22msrc/group-classes/group-classes.service.spec.ts[2m 5/5[22m
[1m[33m ‚ùØ [39m[22msrc/teachers/entities/teacher-availability.entity.spec.ts[2m 0/4[22m
[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m 0/3[22m
[1m[33m ‚ùØ [39m[22mtest/waitlist.e2e.spec.ts[2m 3/4[22m

[2m Test Files [22m[1m[31m10 failed[39m[22m[2m | [22m[1m[32m11 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[31m3 failed[39m[22m[2m | [22m[1m[32m121 passed[39m[22m[2m | [22m[33m70 skipped[39m[90m (202)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m10.44s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K [32m‚úì[39m src/teachers/entities/teacher-availability.entity.spec.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 2[2mms[22m[39m
[90mstdout[2m | src/common/types/class-types.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | src/common/types/class-types.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.

[90mstdout[2m | src/teachers/entities/teacher.entity.spec.ts
[22m[39m[CONFIG] Test mode detected - Using database: wordpress_test
db config: {
  type: [32m'mysql'[39m,
  host: [32m'127.0.0.1'[39m,
  port: [33m3306[39m,
  username: [32m'wordpress'[39m,
  password: [32m'wordpress'[39m,
  database: [32m'wordpress_test'[39m,
  synchronize: [33mfalse[39m,
  logging: [33mfalse[39m,
  entities: [ [32m'dist/**/*.entity{.ts,.js}'[39m ],
  migrations: [ [32m'dist/migrations/*{.ts,.js}'[39m ]
}
[MIGRATIONS] Loaded 27 migrations directly (no file glob needed)

[90mstdout[2m | src/teachers/entities/teacher.entity.spec.ts
[22m[39m[TEST SETUP] Current dir: /Users/davidcook/personal/thrive-wp/apps/nestjs
[TEST SETUP] Loading .env.test from: /Users/davidcook/personal/thrive-wp/apps/nestjs/.env.test
[TEST SETUP] dotenv result: {
  parsed: {
    DB_HOST: [32m'127.0.0.1'[39m,
    DB_PORT: [32m'3306'[39m,
    DB_USERNAME: [32m'wordpress'[39m,
    DB_PASSWORD: [32m'wordpress'[39m,
    DB_DATABASE: [32m'wordpress_test'[39m,
    SESSION_SECRET: [32m'test_session_secret_for_jwt_cookies'[39m,
    GOOGLE_CLIENT_ID: [32m'test-client-id'[39m,
    GOOGLE_CLIENT_SECRET: [32m'test-client-secret'[39m,
    GOOGLE_CALLBACK_URL: [32m'http://localhost:3000/auth/google/callback'[39m
  }
}
[TEST SETUP] DB_HOST after dotenv: 127.0.0.1
process.env.DB_HOST: 127.0.0.1
[TEST SETUP] Migration setup available. Call runMigrations() if needed.


[1m[33m ‚ùØ [39m[22msrc/common/types/class-types.spec.ts[2m 0/3[22m
[1m[33m ‚ùØ [39m[22msrc/teachers/entities/teacher.entity.spec.ts[2m [queued][22m
[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m 0/3[22m
[1m[33m ‚ùØ [39m[22mtest/waitlist.e2e.spec.ts[2m 3/4[22m

[2m Test Files [22m[1m[31m10 failed[39m[22m[2m | [22m[1m[32m12 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[31m3 failed[39m[22m[2m | [22m[1m[32m125 passed[39m[22m[2m | [22m[33m70 skipped[39m[90m (205)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m10.75s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K [32m‚úì[39m src/common/types/class-types.spec.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 4[2mms[22m[39m
 [32m‚úì[39m src/teachers/entities/teacher.entity.spec.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 2[2mms[22m[39m
 [31m‚ùØ[39m test/waitlist.e2e.spec.ts [2m([22m[2m4 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 3172[2mms[22m[39m
[31m   [31m√ó[31m Waitlist (e2e)[2m > [22mshould allow a student to join a waitlist for a full group class session[39m[33m 544[2mms[22m[39m
[31m     ‚Üí Table 'wordpress_test.cancellation_policy' doesn't exist[39m
[31m   [31m√ó[31m Waitlist (e2e)[2m > [22mshould not allow a student to join a waitlist for a session that is not full[39m[33m 396[2mms[22m[39m
[31m     ‚Üí Unknown column 'package_use_id' in 'INSERT INTO'[39m
[31m   [31m√ó[31m Waitlist (e2e)[2m > [22mwhen a booking is cancelled, the first student on the waitlist is notified[39m[33m 907[2mms[22m[39m
[31m     ‚Üí Unknown column 'package_use_id' in 'INSERT INTO'[39m
   [33m[2m‚úì[22m[39m Waitlist (e2e)[2m > [22madmin can promote a student from the waitlist to a booking [33m 1320[2mms[22m[39m

[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m 0/3[22m

[2m Test Files [22m[1m[31m11 failed[39m[22m[2m | [22m[1m[32m14 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[31m3 failed[39m[22m[2m | [22m[1m[32m133 passed[39m[22m[2m | [22m[33m70 skipped[39m[90m (209)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m10.95s
[?2026l[?2026h[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[90mstdout[2m | test/auth-google-start.e2e.spec.ts[2m > [22m[2mAuth Google Start Redirect (e2e)
[22m[39mMigrations complete.

[90mstdout[2m | test/auth-google-start.e2e.spec.ts[2m > [22m[2mAuth Google Start Redirect (e2e)
[22m[39mMigrationTestDataSource destroyed.

[90mstdout[2m | test/auth-google-start.e2e.spec.ts[2m > [22m[2mAuth Google Start Redirect (e2e)[2m > [22m[2mstores same-origin redirect path when provided as absolute URL
[22m[39m[Google Start] WP_BASE_URL: http://localhost:8080
[Google Start] redirect query param (raw): http://localhost:8080/booking-confirmation/?start=2025-10-08T18:00:00.000Z&end=2025-10-08T19:00:00.000Z&teacher=1&serviceType=PRIVATE
[Google Start] redirect query param: http://localhost:8080/booking-confirmation/?start=2025-10-08T18:00:00.000Z&end=2025-10-08T19:00:00.000Z&teacher=1&serviceType=PRIVATE
[Google Start] Setting cookie for domain: localhost value: /booking-confirmation/?start=2025-10-08T18:00:00.000Z&end=2025-10-08T19:00:00.000Z&teacher=1&serviceType=PRIVATE

[90mstdout[2m | test/auth-google-start.e2e.spec.ts[2m > [22m[2mAuth Google Start Redirect (e2e)[2m > [22m[2mpreserves already-encoded query values without normalizing them
[22m[39m[Google Start] WP_BASE_URL: http://localhost:8080
[Google Start] redirect query param (raw): http://localhost:8080/booking-confirmation/?times=2024-09-02T13%253A30%253A00.000Z
[Google Start] redirect query param: http://localhost:8080/booking-confirmation/?times=2024-09-02T13%253A30%253A00.000Z
[Google Start] Setting cookie for domain: localhost value: /booking-confirmation/?times=2024-09-02T13%253A30%253A00.000Z

[90mstdout[2m | test/auth-google-start.e2e.spec.ts[2m > [22m[2mAuth Google Start Redirect (e2e)[2m > [22m[2mignores redirects for other origins
[22m[39m[Google Start] WP_BASE_URL: http://localhost:8080
[Google Start] redirect query param (raw): https://malicious.example/steal
[Google Start] redirect query param: https://malicious.example/steal


[1m[33m ‚ùØ [39m[22mtest/auth-google-start.e2e.spec.ts[2m 1/3[22m

[2m Test Files [22m[1m[31m11 failed[39m[22m[2m | [22m[1m[32m14 passed[39m[22m[90m (26)[39m
[2m      Tests [22m[1m[31m3 failed[39m[22m[2m | [22m[1m[32m134 passed[39m[22m[2m | [22m[33m70 skipped[39m[90m (209)[39m
[2m   Start at [22m15:32:37
[2m   Duration [22m11.15s
[?2026l[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K[1A[K [32m‚úì[39m test/auth-google-start.e2e.spec.ts [2m([22m[2m3 tests[22m[2m)[22m[33m 3561[2mms[22m[39m

[31m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[39m[1m[41m Failed Suites 10 [49m[22m[31m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[39m

[41m[1m FAIL [22m[49m test/course-cohort-enrollment.e2e.spec.ts[2m > [22mCourse Cohort Enrollment (e2e)
[31m[1mQueryFailedError[22m: Can't create table `wordpress_test`.`student_package` (errno: 150 "Foreign key constraint is incorrectly formed")[39m
[90m [2m‚ùØ[22m Query.onResult src/driver/mysql/MysqlQueryRunner.ts:[2m247:33[22m[39m
[90m [2m‚ùØ[22m Query.execute node_modules/mysql2/lib/commands/command.js:[2m36:14[22m[39m
[90m [2m‚ùØ[22m PoolConnection.handlePacket node_modules/mysql2/lib/base/connection.js:[2m475:34[22m[39m
[90m [2m‚ùØ[22m PacketParser.onPacket node_modules/mysql2/lib/base/connection.js:[2m93:12[22m[39m
[90m [2m‚ùØ[22m PacketParser.executeStart node_modules/mysql2/lib/packet_parser.js:[2m75:16[22m[39m
[90m [2m‚ùØ[22m Socket.<anonymous> node_modules/mysql2/lib/base/connection.js:[2m100:25[22m[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[1/14]‚éØ[22m[39m

[41m[1m FAIL [22m[49m test/credit-tiers-integration.e2e.spec.ts[2m > [22mCredit Tier System Integration (e2e)
[41m[1m FAIL [22m[49m test/database.e2e.spec.ts[2m > [22mDatabase Integration (e2e)
[41m[1m FAIL [22m[49m test/group-class-booking.e2e.spec.ts[2m > [22mGroup Class Booking (e2e)
[41m[1m FAIL [22m[49m test/payments-session-booking.e2e.spec.ts[2m > [22mPaymentsService.createSessionAndBookingFromMetadata (e2e)
[41m[1m FAIL [22m[49m test/students-api.e2e.spec.ts[2m > [22mStudents API (e2e)
[41m[1m FAIL [22m[49m test/teacher-availability.e2e.spec.ts[2m > [22mTeacherAvailabilityService (e2e)
[31m[1mQueryFailedError[22m: Duplicate column name 'password_hash'[39m
[90m [2m‚ùØ[22m Query.onResult src/driver/mysql/MysqlQueryRunner.ts:[2m247:33[22m[39m
[90m [2m‚ùØ[22m Query.execute node_modules/mysql2/lib/commands/command.js:[2m36:14[22m[39m
[90m [2m‚ùØ[22m PoolConnection.handlePacket node_modules/mysql2/lib/base/connection.js:[2m475:34[22m[39m
[90m [2m‚ùØ[22m PacketParser.onPacket node_modules/mysql2/lib/base/connection.js:[2m93:12[22m[39m
[90m [2m‚ùØ[22m PacketParser.executeStart node_modules/mysql2/lib/packet_parser.js:[2m75:16[22m[39m
[90m [2m‚ùØ[22m Socket.<anonymous> node_modules/mysql2/lib/base/connection.js:[2m100:25[22m[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[2/14]‚éØ[22m[39m

[41m[1m FAIL [22m[49m test/package-booking.e2e.spec.ts[2m > [22mPackage Booking (e2e)
[31m[1mQueryFailedError[22m: Table 'wordpress_test.migrations' doesn't exist[39m
[90m [2m‚ùØ[22m Query.onResult src/driver/mysql/MysqlQueryRunner.ts:[2m247:33[22m[39m
[90m [2m‚ùØ[22m Query.execute node_modules/mysql2/lib/commands/command.js:[2m36:14[22m[39m
[90m [2m‚ùØ[22m PoolConnection.handlePacket node_modules/mysql2/lib/base/connection.js:[2m475:34[22m[39m
[90m [2m‚ùØ[22m PacketParser.onPacket node_modules/mysql2/lib/base/connection.js:[2m93:12[22m[39m
[90m [2m‚ùØ[22m PacketParser.executeStart node_modules/mysql2/lib/packet_parser.js:[2m75:16[22m[39m
[90m [2m‚ùØ[22m Socket.<anonymous> node_modules/mysql2/lib/base/connection.js:[2m100:25[22m[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[3/14]‚éØ[22m[39m

[41m[1m FAIL [22m[49m test/payments-webhook-group-booking.e2e.spec.ts[2m > [22mPaymentsService - Group Session Booking via Package Purchase Webhook
[31m[1mQueryFailedError[22m: Can't create table `wordpress_test`.`course_cohort` (errno: 150 "Foreign key constraint is incorrectly formed")[39m
[90m [2m‚ùØ[22m Query.onResult src/driver/mysql/MysqlQueryRunner.ts:[2m247:33[22m[39m
[90m [2m‚ùØ[22m Query.execute node_modules/mysql2/lib/commands/command.js:[2m36:14[22m[39m
[90m [2m‚ùØ[22m PoolConnection.handlePacket node_modules/mysql2/lib/base/connection.js:[2m475:34[22m[39m
[90m [2m‚ùØ[22m PacketParser.onPacket node_modules/mysql2/lib/base/connection.js:[2m93:12[22m[39m
[90m [2m‚ùØ[22m PacketParser.executeStart node_modules/mysql2/lib/packet_parser.js:[2m75:16[22m[39m
[90m [2m‚ùØ[22m Socket.<anonymous> node_modules/mysql2/lib/base/connection.js:[2m100:25[22m[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[4/14]‚éØ[22m[39m

[41m[1m FAIL [22m[49m test/students-api.e2e.spec.ts[2m > [22mStudents API (e2e)
[31m[1mTypeError[22m: Cannot read properties of undefined (reading 'close')[39m
[36m [2m‚ùØ[22m test/students-api.e2e.spec.ts:[2m35:15[22m[39m
    [90m 33| [39m
    [90m 34| [39m  [34mafterAll[39m([35masync[39m () [33m=>[39m {
    [90m 35| [39m    [35mawait[39m app[33m.[39m[34mclose[39m()[33m;[39m
    [90m   | [39m              [31m^[39m
    [90m 36| [39m  })[33m;[39m
    [90m 37| [39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[5/14]‚éØ[22m[39m

[41m[1m FAIL [22m[49m src/teachers/teachers.service.spec.ts[2m > [22mTeachersService[2m > [22mpreviewTeacherAvailability
[31m[1mError[22m: No test found in suite previewTeacherAvailability[39m
[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[6/14]‚éØ[22m[39m


[31m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[39m[1m[41m Failed Tests 3 [49m[22m[31m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[39m

[41m[1m FAIL [22m[49m test/waitlist.e2e.spec.ts[2m > [22mWaitlist (e2e)[2m > [22mshould allow a student to join a waitlist for a full group class session
[31m[1mQueryFailedError[22m: Table 'wordpress_test.cancellation_policy' doesn't exist[39m
[90m [2m‚ùØ[22m Query.onResult src/driver/mysql/MysqlQueryRunner.ts:[2m247:33[22m[39m
[90m [2m‚ùØ[22m Query.execute node_modules/mysql2/lib/commands/command.js:[2m36:14[22m[39m
[90m [2m‚ùØ[22m PoolConnection.handlePacket node_modules/mysql2/lib/base/connection.js:[2m475:34[22m[39m
[90m [2m‚ùØ[22m PacketParser.onPacket node_modules/mysql2/lib/base/connection.js:[2m93:12[22m[39m
[90m [2m‚ùØ[22m PacketParser.executeStart node_modules/mysql2/lib/packet_parser.js:[2m75:16[22m[39m
[90m [2m‚ùØ[22m Socket.<anonymous> node_modules/mysql2/lib/base/connection.js:[2m100:25[22m[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[7/14]‚éØ[22m[39m

[41m[1m FAIL [22m[49m test/waitlist.e2e.spec.ts[2m > [22mWaitlist (e2e)[2m > [22mshould not allow a student to join a waitlist for a session that is not full
[41m[1m FAIL [22m[49m test/waitlist.e2e.spec.ts[2m > [22mWaitlist (e2e)[2m > [22mwhen a booking is cancelled, the first student on the waitlist is notified
[31m[1mQueryFailedError[22m: Unknown column 'package_use_id' in 'INSERT INTO'[39m
[90m [2m‚ùØ[22m Query.onResult src/driver/mysql/MysqlQueryRunner.ts:[2m247:33[22m[39m
[90m [2m‚ùØ[22m Query.execute node_modules/mysql2/lib/commands/command.js:[2m36:14[22m[39m
[90m [2m‚ùØ[22m PoolConnection.handlePacket node_modules/mysql2/lib/base/connection.js:[2m475:34[22m[39m
[90m [2m‚ùØ[22m PacketParser.onPacket node_modules/mysql2/lib/base/connection.js:[2m93:12[22m[39m
[90m [2m‚ùØ[22m PacketParser.executeStart node_modules/mysql2/lib/packet_parser.js:[2m75:16[22m[39m
[90m [2m‚ùØ[22m Socket.<anonymous> node_modules/mysql2/lib/base/connection.js:[2m100:25[22m[39m

[31m[2m‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ[8/14]‚éØ[22m[39m


[2m Test Files [22m [1m[31m11 failed[39m[22m[2m | [22m[1m[32m15 passed[39m[22m[90m (26)[39m
[2m      Tests [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m136 passed[39m[22m[2m | [22m[33m70 skipped[39m[90m (209)[39m
[2m   Start at [22m 15:32:37
[2m   Duration [22m 11.28s[2m (transform 1.80s, setup 19.42s, collect 30.30s, tests 15.27s, environment 3ms, prepare 2.51s)[22m

[?25h[41m[30m‚ÄâELIFECYCLE‚Äâ[39m[49m [31mTest failed. See above for more details.[39m
