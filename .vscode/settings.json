{
  // Run and debug tests from VS Code matching our TS specs
  "jestrunner.include": ["**/*.spec.ts", "**/*.e2e.spec.ts"],

  // Point Jest Runner to the NestJS project config (relative to projectPath)
  "jestrunner.configPath": "jest.config.mjs",

  // Run tests via our npm script so Node flags and env (.env.test) are applied
  // Note: projectPath makes the command run inside the nestjs folder
  "jestrunner.jestCommand": "npm run test --",
  "jestrunner.projectPath": "./nestjs",

  // Helpful defaults for DB-based e2e tests
  "jestrunner.runOptions": ["--runInBand", "--colors"],

  // Ensure debug runs also use Node's ESM vm modules
  "jestrunner.debugOptions": {
    "runtimeExecutable": "node",
    "runtimeArgs": ["--experimental-vm-modules"],
    "projectPath": "./nestjs",
    // Ensure debug runs mimic `npm run test` (which loads .env.test)
    // so TypeORM uses localhost instead of Docker hostname 'db'.
    "env": {
      "NODE_ENV": "test",
      "DB_HOST": "localhost",
      "DB_PORT": "3306",
      "DB_USERNAME": "wordpress",
      "DB_PASSWORD": "wordpress",
      "DB_DATABASE_TEST": "wordpress_test",
      "DB_SYNCHRONIZE": "false"
    }
  }
}
